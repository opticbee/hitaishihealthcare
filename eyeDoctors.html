<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hitaishi Healthcare Services</title>
    <script defer src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

</head>
<body style="overflow-x: hidden; margin: 0; padding: 0; font-family: Arial, sans-serif; background-color: #f4f4f4;">

    

<!-- Navigation Bar 1 -->
<nav style="display: flex; align-items: center; justify-content: space-between; background: #007bff; padding: 10px 20px; flex-wrap: wrap; position: relative;">

  <!-- Left: Logo & Title -->
  <div style="display: flex; align-items: center; gap: 10px;">
    <img src="images/Hitaishi HealthCare (1).png" alt="Logo" style="height: 40px;">
    <div>
      <h2 style="color: #fff; margin: 0; font-size: 22px;">Hitaishi</h2>
      <p style="color: #fff; margin: 0; font-size: 12px;">HealthCare Service</p>
    </div>
    <!-- Search Icon After Title -->
    <div style="position: relative; margin-left: 10px;">
      <input type="text" placeholder="Search..." style="padding: 8px 30px 8px 10px; border-radius: 5px; border: none; font-size: 14px;">
      <i class="fas fa-search" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: #007bff;"></i>
    </div>
  </div>

  <!-- Hamburger & Close (Mobile only) -->
  <div onclick="toggleMenu1()" id="hamburger1" style="font-size: 26px; color: white; cursor: pointer; display: none;">&#9776;</div>
  <div onclick="toggleMenu1()" id="closeIcon1" style="font-size: 26px; color: white; cursor: pointer; display: none;">&times;</div>

  <!-- Center: Nav Items -->
  <div id="navItems1" style="display: flex; flex-wrap: wrap; gap: 10px; align-items: center; justify-content: center; flex: 1; margin-left: 20px; margin-right: 20px;">
    <a href="blood.html" style="background: white; color: #007bff; padding: 8px 12px; border-radius: 5px; font-size: 14px; text-decoration: none; font-weight: bold;">❤️ Blood</a>
    <a href="clinics.html" style="background: white; color: #007bff; padding: 8px 12px; border-radius: 5px; font-size: 14px; text-decoration: none; font-weight: bold;">Appointment</a>
    <a href="doctors.html" style="background: white; color: #007bff; padding: 8px 12px; border-radius: 5px; font-size: 14px; text-decoration: none; font-weight: bold;">Doctors</a>
    <a href="clinic.html" style="background: white; color: #007bff; padding: 8px 12px; border-radius: 5px; font-size: 14px; text-decoration: none; font-weight: bold;">Clinic</a>
    <a href="Eyecare.html" style="background: white; color: #007bff; padding: 8px 12px; border-radius: 5px; font-size: 14px; text-decoration: none; font-weight: bold;">Eye Care</a>
  </div>

  <!-- Right: Social Media Icons -->
  <div style="display: flex; gap: 10px; align-items: center;">
    <a href="https://facebook.com" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-facebook"></i></a>
    <a href="https://x.com" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-twitter"></i></a>
    <a href="https://instagram.com" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-instagram"></i></a>
    <a href="https://linkedin.com" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-linkedin"></i></a>
    <a href="https://youtube.com" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-youtube"></i></a>
    <a href="https://t.me" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-telegram"></i></a>
    <a href="https://wa.me" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-whatsapp"></i></a>
    <a href="patientLogin.html" style="color: white; font-size: 20px;"><i class="fas fa-user-circle"></i></a>
  </div>
</nav>

<!-- Navigation Bar 2 -->
<nav style="background-color: #2581de; padding: 1rem 2rem; position: sticky; top: 0; box-shadow: 0px 4px 10px rgba(0,0,0,0.1); z-index: 1000;">
    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
        <div onclick="toggleMenu2()" style="font-size: 26px; color: white; cursor: pointer; display: none;" id="hamburger2">&#9776;</div>
        <div onclick="toggleMenu2()" style="font-size: 26px; color: white; cursor: pointer; display: none;" id="closeIcon2">&times;</div>
    </div>
    <div id="navLinks2" style="display: flex; flex-wrap: wrap; align-items: center; justify-content: center; gap: 1rem; margin-top: 10px;">
        <div style="position: relative;"><a href="index.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">Home</a></div>

        <div style="position: relative;">
            <a href="healthRecords.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">
                Health Records <i class="fas fa-caret-down"></i>
            </a>
            <div style="display: none; position: absolute; background-color: white; min-width: 180px; border-radius: 5px; overflow: hidden; box-shadow: 0px 4px 10px rgba(0,0,0,0.1);">
                <a href="bloodtest.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Blood Tests</a>
                <a href="donations.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Donations</a>
                <a href="inventory.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Inventory</a>
            </div>
        </div>

        <div style="position: relative;">
            <a href="Diagnostics.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">
                Diagnostics <i class="fas fa-caret-down"></i>
            </a>
            <div style="display: none; position: absolute; background-color: white; min-width: 180px; border-radius: 5px; overflow: hidden; box-shadow: 0px 4px 10px rgba(0,0,0,0.1);">
                <a href="xray.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">X-Ray</a>
                <a href="ultrasound.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Ultrasound</a>
                <a href="mri.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">MRI</a>
            </div>
        </div>

        <div style="position: relative;">
            <a href="Physician.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">
                Physicians <i class="fas fa-caret-down"></i>
            </a>
            <div style="display: none; position: absolute; background-color: white; min-width: 180px; border-radius: 5px; overflow: hidden; box-shadow: 0px 4px 10px rgba(0,0,0,0.1);">
                <a href="cardiologist.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Cardiologist</a>
                <a href="neuralogist.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Neurologist</a>
                <a href="dermatologist.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Dermatologist</a>
            </div>
        </div>

        <div style="position: relative;">
            <a href="fertility.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">
                Fertility <i class="fas fa-caret-down"></i>
            </a>
            <div style="display: none; position: absolute; background-color: white; min-width: 180px; border-radius: 5px; overflow: hidden; box-shadow: 0px 4px 10px rgba(0,0,0,0.1);">
                <a href="IVF.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">IVF</a>
                <a href="iui.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">IUI</a>
                <a href="sarogasi.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Surrogacy</a>
            </div>
        </div>

        <a href="ai.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">AI & Blockchain</a>
        <a href="doctor.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">Doctors</a>
        <a href="patientLogin.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">Patients</a>
        <a href="Cancer.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">Cancer</a>
        <a href="Dental.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">Dental</a>
        <a href="ENT.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">ENT</a>
        <a href="contact.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">Contact</a>
    </div>
</nav>

<script>
  // Navbar 1
  function toggleMenu1() {
    const navItems = document.getElementById('navItems1');
    const hamburger = document.getElementById('hamburger1');
    const closeIcon = document.getElementById('closeIcon1');
    const isHidden = navItems.style.display === 'none' || navItems.style.display === '';
    if (isHidden) {
      navItems.style.display = 'flex';
      navItems.style.flexDirection = 'column';
      hamburger.style.display = 'none';
      closeIcon.style.display = 'block';
    } else {
      navItems.style.display = 'none';
      hamburger.style.display = 'block';
      closeIcon.style.display = 'none';
    }
  }
  function checkScreenWidth1() {
    const navItems = document.getElementById('navItems1');
    const hamburger = document.getElementById('hamburger1');
    const closeIcon = document.getElementById('closeIcon1');
    if (window.innerWidth <= 768) {
      navItems.style.display = 'none';
      hamburger.style.display = 'block';
      closeIcon.style.display = 'none';
    } else {
      navItems.style.display = 'flex';
      navItems.style.flexDirection = 'row';
      hamburger.style.display = 'none';
      closeIcon.style.display = 'none';
    }
  }
  window.addEventListener('resize', checkScreenWidth1);
  window.addEventListener('DOMContentLoaded', checkScreenWidth1);

  // Navbar 2
  function toggleMenu2() {
    const nav = document.getElementById("navLinks2");
    const ham = document.getElementById("hamburger2");
    const close = document.getElementById("closeIcon2");
    if (nav.style.display === "none" || nav.style.display === "") {
        nav.style.display = "flex";
        nav.style.flexDirection = "column";
        nav.style.alignItems = "center";
        ham.style.display = "none";
        close.style.display = "block";
    } else {
        nav.style.display = "none";
        ham.style.display = "block";
        close.style.display = "none";
    }
  }
  function setResponsiveMenu2() {
    const nav = document.getElementById("navLinks2");
    const ham = document.getElementById("hamburger2");
    const close = document.getElementById("closeIcon2");
    if (window.innerWidth <= 768) {
        nav.style.display = "none";
        ham.style.display = "block";
        close.style.display = "none";
    } else {
        nav.style.display = "flex";
        nav.style.flexDirection = "row";
        nav.style.justifyContent = "center";
        ham.style.display = "none";
        close.style.display = "none";
    }
  }
  window.addEventListener('resize', setResponsiveMenu2);
  window.addEventListener('DOMContentLoaded', setResponsiveMenu2);

  // Dropdowns on hover (desktop) and tap (mobile) for Navbar 2
  function setupDropdowns2() {
    document.querySelectorAll('#navLinks2 > div').forEach(item => {
        const dropdown = item.querySelector('div');
        item.onmouseenter = null;
        item.onmouseleave = null;
        item.onclick = null;
        if (dropdown) {
            if (window.innerWidth > 768) {
                item.addEventListener('mouseenter', () => dropdown.style.display = 'block');
                item.addEventListener('mouseleave', () => dropdown.style.display = 'none');
            } else {
                item.addEventListener('click', function(e) {
                    if (e.target === item.querySelector('a')) {
                        e.preventDefault();
                        dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
                    }
                });
            }
        }
    });
  }
  window.addEventListener('resize', setupDropdowns2);
  window.addEventListener('DOMContentLoaded', setupDropdowns2);
</script>


<!-- Main Content -->
<div class="responsive-container" style="display: flex; min-height: calc(100vh - 100px);">

  <!-- Left Side - Doctors List -->
  <div style="width: 40%; padding: 20px; overflow-y: auto; background-color: white;">
    <h2 style="color: #333; margin-bottom: 20px;">Available Specialists</h2>
    
    <!-- Filters -->
    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
      <select id="specializationFilter" style="padding: 10px; border-radius: 5px; border: 1px solid #ddd; flex-grow: 1;">
        <option value="">All Specializations</option>
      </select>
      <select id="experienceFilter" style="padding: 10px; border-radius: 5px; border: 1px solid #ddd; width: 150px;">
        <option value="">Any Experience</option>
        <option value="5">5+ years</option>
        <option value="10">10+ years</option>
        <option value="15">15+ years</option>
      </select>
    </div>

    <!-- Doctors List -->
    <div id="doctorsList" style="display: flex; flex-direction: column; gap: 15px;">
      <!-- Doctors will be loaded here -->
    </div>
  </div>

  <!-- Right Side - Map and Location Details -->
  <div style="width: 60%; position: relative;">

    <!-- Selected Doctor Details -->
    <div id="doctorDetails" style="padding: 20px; background-color: white; height: calc(50% - 120px); overflow-y: auto; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); margin: 20px; transition: all 0.3s ease;">
      <h3 style="color: #333; margin-bottom: 15px;">Doctor Information</h3>
      <p>Select a doctor to view details</p>
    </div>

    <!-- Location Search -->
    <div style="padding: 20px; background-color: white; border-bottom: 1px solid #eee;">
      <div style="display: flex; gap: 10px;">
        <input type="text" id="locationSearch" placeholder="Search location..." style="padding: 10px; border-radius: 5px; border: 1px solid #ddd; flex-grow: 1;">
        <button onclick="useCurrentLocation()" style="padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">Use Current Location</button>
      </div>
      <div style="margin-top: 10px;">
        <p style="font-weight: bold; margin-bottom: 5px;">Popular Areas:</p>
        <div id="popularAreas" style="display: flex; flex-wrap: wrap; gap: 10px;">
          <span style="padding: 5px 10px; background-color: #f0f0f0; border-radius: 15px; cursor: pointer;">Hyderabad</span>
          <span style="padding: 5px 10px; background-color: #f0f0f0; border-radius: 15px; cursor: pointer;">Secunderabad</span>
          <span style="padding: 5px 10px; background-color: #f0f0f0; border-radius: 15px; cursor: pointer;">Gachibowli</span>
          <span style="padding: 5px 10px; background-color: #f0f0f0; border-radius: 15px; cursor: pointer;">Banjara Hills</span>
        </div>
      </div>
    </div>

    <!-- Map Container -->
    <div id="map" style="height: 50%; width: 100%;"></div>

  </div>
</div>

<!-- Responsive CSS -->
<style>
  @media (max-width: 768px) {
    .responsive-container {
      flex-direction: column;
    }

    .responsive-container > div:first-child {
      width: 100% !important;
    }

    .responsive-container > div:last-child {
      width: 100% !important;
    }

    #doctorDetails {
      height: auto !important;
      margin: 10px !important;
    }

    #map {
      height: 300px !important;
    }

    #specializationFilter, #experienceFilter {
      width: 100% !important;
    }

    #locationSearch {
      width: 100% !important;
      margin-bottom: 10px;
    }

    button[onclick="useCurrentLocation()"] {
      width: 100% !important;
    }
  }
</style>


<script>
let allDoctors = [];
let map;
let markers = [];
let selectedDoctor = null;
let selectedSlot = null;

document.addEventListener('DOMContentLoaded', () => {
  initMap();
  fetchDoctors();
  setupEventListeners();
});

function initMap() {
  const hyderabad = { lat: 17.3850, lng: 78.4867 };
  map = new google.maps.Map(document.getElementById("map"), {
    center: hyderabad,
    zoom: 12,
  });

  const input = document.getElementById("locationSearch");
  const autocomplete = new google.maps.places.Autocomplete(input);
  autocomplete.bindTo("bounds", map);

  autocomplete.addListener("place_changed", () => {
    const place = autocomplete.getPlace();
    if (!place.geometry || !place.geometry.location) return;
    map.setCenter(place.geometry.location);
    map.setZoom(14);
  });
}

async function fetchDoctors() {
  try {
    const response = await fetch('https://hitaishihealthcare.com/api/getdoctors');
    const data = await response.json();
    allDoctors = data;
    displayDoctors(allDoctors);
    updateMapMarkers(allDoctors);
  } catch (error) {
    console.error('Error fetching doctors:', error);
    document.getElementById('doctorsList').innerHTML =
      '<p style="color: red;">Failed to load doctors. Please try again later.</p>';
  }
}

function displayDoctors(doctors) {
  const doctorsList = document.getElementById('doctorsList');
  doctorsList.innerHTML = '';

  doctors.forEach(doctor => {
    const doctorCard = document.createElement('div');
    doctorCard.style = 'border: 1px solid #ddd; border-radius: 8px; padding: 15px; cursor: pointer;';
    doctorCard.onclick = () => showDoctorDetails(doctor);

    doctorCard.innerHTML = `
      <div style="display: flex; gap: 15px;">
        <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Doctor" style="width: 60px; height: 60px; border-radius: 50%;">
        <div style="flex-grow: 1;">
          <h3 style="margin: 0 0 5px 0; color: #007bff;">Dr. ${doctor.first_name} ${doctor.last_name}</h3>
          <p style="margin: 0 0 5px 0; color: #666;">${doctor.specialization}</p>
          <p style="margin: 0 0 5px 0; font-size: 14px;">
            <span style="color: #28a745;">${doctor.experience} years experience</span> | 
            <span>${doctor.clinic}</span>
          </p>
        </div>
        <div style="text-align: right;">
          <p style="margin: 0 0 5px 0; font-weight: bold;">₹${Math.floor(Math.random() * 500) + 500} consultation fee</p>
        </div>
      </div>
    `;
    doctorsList.appendChild(doctorCard);
  });
}

function showDoctorDetails(doctor) {
  selectedDoctor = doctor;
  const detailsDiv = document.getElementById('doctorDetails');
  const today = new Date().toISOString().split('T')[0];

  detailsDiv.innerHTML = `
    <div style="padding: 20px; border-radius: 10px; background-color: #ffffff; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
      <h3 style="color: #007bff; margin-top: 0; margin-bottom: 10px;">Dr. ${doctor.first_name} ${doctor.last_name}</h3>
      <p style="margin: 0 0 10px 0; color: #666;"><strong>Specialization:</strong> ${doctor.specialization}</p>
      
      <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 15px;">
        <div style="flex: 1; min-width: 200px;">
          <p style="margin: 5px 0;"><strong>Experience:</strong> ${doctor.experience} years</p>
          <p style="margin: 5px 0;"><strong>Clinic:</strong> ${doctor.clinic}</p>
          <p style="margin: 5px 0;"><strong>Address:</strong> ${doctor.address}</p>
        </div>
        <div style="flex: 1; min-width: 200px;">
          <p style="margin: 5px 0;"><strong>Availability:</strong> ${doctor.availability}</p>
          <p style="margin: 5px 0;"><strong>Timings:</strong> ${doctor.from_time} - ${doctor.to_time}</p>
          <p style="margin: 5px 0;"><strong>Contact:</strong> ${doctor.mobile}</p>
        </div>
      </div>

      <div style="background-color: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
        <h4 style="margin-top: 0; margin-bottom: 10px; color: #333;">About Doctor</h4>
        <p style="margin: 0; color: #555;">Dr. ${doctor.first_name} graduated with a degree in ${doctor.degree} from ${doctor.university} and has ${doctor.experience} years of experience in ${doctor.specialization}.</p>
      </div>

      <div style="margin-top: 20px;">
        <label style="font-weight: bold; display: block; margin-bottom: 8px;">Select Appointment Date:</label>
        <input type="date" id="appointmentDate" min="${today}" onchange="loadTimeSlots('${doctor.id}', '${doctor.from_time}', '${doctor.to_time}')" style="padding: 10px; border: 1px solid #ccc; border-radius: 5px; width: 100%;">
      </div>

      <div id="timeSlots" style="margin-top: 20px;"></div>
    </div>
  `;
}

function loadTimeSlots(doctorId, fromTime, toTime) {
  const date = document.getElementById("appointmentDate").value;
  if (!date) return;

  const slotContainer = document.getElementById("timeSlots");
  slotContainer.innerHTML = "<p>Loading slots...</p>";

  fetch(`https://hitaishihealthcare.com/api/getBookedSlots?doctorId=${doctorId}&date=${date}`)
    .then(res => res.json())
    .then(bookedSlots => {
      slotContainer.innerHTML = '';
      selectedSlot = null;

      const start = new Date(`1970-01-01T${fromTime}`);
      const end = new Date(`1970-01-01T${toTime}`);

      if (isNaN(start) || isNaN(end)) {
        slotContainer.innerHTML = `<p style="color: red;">Invalid timing format.</p>`;
        return;
      }

      while (start < end) {
        const slotTime = start.toTimeString().substring(0, 5);
        const isBooked = bookedSlots.includes(slotTime);

        const btn = document.createElement('button');
        btn.textContent = slotTime;
        btn.style = `
          padding: 10px 15px;
          margin: 5px;
          border: none;
          border-radius: 5px;
          background-color: ${isBooked ? '#ccc' : '#f0f8ff'};
          color: ${isBooked ? '#888' : '#000'};
          cursor: ${isBooked ? 'not-allowed' : 'pointer'};
        `;

        if (!isBooked) {
          btn.onclick = () => selectSlot(btn, slotTime);
        }

        slotContainer.appendChild(btn);
        start.setMinutes(start.getMinutes() + 30);
      }

      const submitBtn = document.createElement('button');
      submitBtn.textContent = 'Submit';
      submitBtn.style = `
        display: block;
        margin-top: 20px;
        padding: 10px 20px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      `;
      submitBtn.onclick = () => submitSlot(doctorId, date);
      slotContainer.appendChild(submitBtn);
    })
    .catch(err => {
      console.error("Slot load error:", err);
      slotContainer.innerHTML = `<p style="color:red;">Unable to load time slots.</p>`;
    });
}

function selectSlot(btn, time) {
  document.querySelectorAll('#timeSlots button').forEach(b => {
    if (b.textContent !== 'Submit') {
      b.style.backgroundColor = '#f0f8ff';
      b.style.color = 'black';
    }
  });
  btn.style.backgroundColor = '#007bff';
  btn.style.color = 'white';
  selectedSlot = time;
}

function submitSlot(doctorId, date) {
  if (!selectedSlot) return alert("Please select a time slot");

  fetch('https://hitaishihealthcare.com/api/bookSlot', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      doctorId,
      doctorUid: selectedDoctor.uid,
      slot: selectedSlot,
      date
    })
  })
    .then(res => res.json())
    .then(data => {
      alert('Appointment booked at ' + selectedSlot);
      document.getElementById('timeSlots').innerHTML = '';
    })
    .catch(err => {
      console.error(err);
      alert('Booking failed. Please try again.');
    });
}

function updateMapMarkers(doctors) {
  markers.forEach(marker => marker.setMap(null));
  markers = [];

  doctors.forEach(doctor => {
    if (doctor.address) {
      const geocoder = new google.maps.Geocoder();
      geocoder.geocode({ address: doctor.address }, (results, status) => {
        if (status === "OK" && results[0]) {
          const marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location,
            title: `${doctor.first_name} ${doctor.last_name} - ${doctor.clinic}`
          });
          markers.push(marker);
          marker.addListener('click', () => showDoctorDetails(doctor));
        }
      });
    }
  });
}

function setupEventListeners() {
  document.getElementById('specializationFilter').addEventListener('change', filterDoctors);
  document.getElementById('experienceFilter').addEventListener('change', filterDoctors);

  document.querySelectorAll('#popularAreas span').forEach(span => {
    span.addEventListener('click', function () {
      const area = this.textContent;
      document.getElementById('locationSearch').value = area;

      const geocoder = new google.maps.Geocoder();
      geocoder.geocode({ address: area + ', Hyderabad' }, (results, status) => {
        if (status === "OK" && results[0]) {
          map.setCenter(results[0].geometry.location);
          map.setZoom(14);
        }
      });
    });
  });
}

function filterDoctors() {
  const specialization = document.getElementById('specializationFilter').value;
  const experience = document.getElementById('experienceFilter').value;

  let filtered = allDoctors;

  if (specialization) {
    filtered = filtered.filter(doc => doc.specialization === specialization);
  }
  if (experience) {
    filtered = filtered.filter(doc => parseInt(doc.experience) >= parseInt(experience));
  }

  displayDoctors(filtered);
  updateMapMarkers(filtered);
}

function useCurrentLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      pos => {
        const location = {
          lat: pos.coords.latitude,
          lng: pos.coords.longitude
        };
        map.setCenter(location);
        map.setZoom(14);

        const geocoder = new google.maps.Geocoder();
        geocoder.geocode({ location }, (results, status) => {
          if (status === "OK" && results[0]) {
            document.getElementById('locationSearch').value = results[0].formatted_address;
          }
        });
      },
      () => alert("Geolocation failed or unsupported.")
    );
  } else {
    alert("Geolocation not supported by your browser.");
  }
}
</script>


  
</body>
</html>
