<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Patient Chat</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://cdn.tailwindcss.com"></script>

</head>
<body>



<!-- Navigation Bar 1 -->
<nav style="display: flex; align-items: center; justify-content: space-between; background: #007bff; padding: 10px 20px; flex-wrap: wrap; position: relative;">

  <!-- Left: Logo & Title -->
  <div style="display: flex; align-items: center; gap: 10px;">
    <img src="images/Hitaishi HealthCare (1).png" alt="Logo" style="height: 40px;">
    <div>
      <h2 style="color: #fff; margin: 0; font-size: 22px;">Hitaishi</h2>
      <p style="color: #fff; margin: 0; font-size: 12px;">HealthCare Service</p>
    </div>
    <!-- Search Icon After Title -->
    <div style="position: relative; margin-left: 10px;">
      <input type="text" placeholder="Search..." style="padding: 8px 30px 8px 10px; border-radius: 5px; border: none; font-size: 14px;">
      <i class="fas fa-search" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: #007bff;"></i>
    </div>
  </div>

  <!-- Hamburger & Close (Mobile only) -->
  <div onclick="toggleMenu1()" id="hamburger1" style="font-size: 26px; color: white; cursor: pointer; display: none;">&#9776;</div>
  <div onclick="toggleMenu1()" id="closeIcon1" style="font-size: 26px; color: white; cursor: pointer; display: none;">&times;</div>

  <!-- Center: Nav Items -->
  <div id="navItems1" style="display: flex; flex-wrap: wrap; gap: 10px; align-items: center; justify-content: center; flex: 1; margin-left: 20px; margin-right: 20px;">
    <a href="blood.html" style="background: white; color: #007bff; padding: 8px 12px; border-radius: 5px; font-size: 14px; text-decoration: none; font-weight: bold;">❤️ Blood</a>
    <a href="clinics.html" style="background: white; color: #007bff; padding: 8px 12px; border-radius: 5px; font-size: 14px; text-decoration: none; font-weight: bold;">Appointment</a>
    <a href="doctors.html" style="background: white; color: #007bff; padding: 8px 12px; border-radius: 5px; font-size: 14px; text-decoration: none; font-weight: bold;">Doctors</a>
    <a href="clinic.html" style="background: white; color: #007bff; padding: 8px 12px; border-radius: 5px; font-size: 14px; text-decoration: none; font-weight: bold;">Clinic</a>
    <a href="Eyecare.html" style="background: white; color: #007bff; padding: 8px 12px; border-radius: 5px; font-size: 14px; text-decoration: none; font-weight: bold;">Eye Care</a>
  </div>

  <!-- Right: Social Media Icons -->
  <div style="display: flex; gap: 10px; align-items: center;">
    <a href="https://facebook.com" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-facebook"></i></a>
    <a href="https://x.com" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-twitter"></i></a>
    <a href="https://instagram.com" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-instagram"></i></a>
    <a href="https://linkedin.com" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-linkedin"></i></a>
    <a href="https://youtube.com" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-youtube"></i></a>
    <a href="https://t.me" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-telegram"></i></a>
    <a href="https://wa.me" target="_blank" style="color: white; font-size: 18px;"><i class="fab fa-whatsapp"></i></a>
    <a href="patientLogin.html" style="color: white; font-size: 20px;"><i class="fas fa-user-circle"></i></a>
  </div>
</nav>

<!-- Navigation Bar 2 -->
<nav style="background-color: #2581de; padding: 1rem 2rem; position: sticky; top: 0; box-shadow: 0px 4px 10px rgba(0,0,0,0.1); z-index: 1000;">
    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
        <div onclick="toggleMenu2()" style="font-size: 26px; color: white; cursor: pointer; display: none;" id="hamburger2">&#9776;</div>
        <div onclick="toggleMenu2()" style="font-size: 26px; color: white; cursor: pointer; display: none;" id="closeIcon2">&times;</div>
    </div>
    <div id="navLinks2" style="display: flex; flex-wrap: wrap; align-items: center; justify-content: center; gap: 1rem; margin-top: 10px;">
        <div style="position: relative;"><a href="index.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">Home</a></div>

        <div style="position: relative;">
            <a href="healthRecords.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">
                Health Records <i class="fas fa-caret-down"></i>
            </a>
            <div style="display: none; position: absolute; background-color: white; min-width: 180px; border-radius: 5px; overflow: hidden; box-shadow: 0px 4px 10px rgba(0,0,0,0.1);">
                <a href="bloodtest.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Blood Tests</a>
                <a href="donations.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Donations</a>
                <a href="inventory.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Inventory</a>
            </div>
        </div>

        <div style="position: relative;">
            <a href="Diagnostics.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">
                Diagnostics <i class="fas fa-caret-down"></i>
            </a>
            <div style="display: none; position: absolute; background-color: white; min-width: 180px; border-radius: 5px; overflow: hidden; box-shadow: 0px 4px 10px rgba(0,0,0,0.1);">
                <a href="xray.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">X-Ray</a>
                <a href="ultrasound.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Ultrasound</a>
                <a href="mri.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">MRI</a>
            </div>
        </div>

        <div style="position: relative;">
            <a href="Physician.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">
                Physicians <i class="fas fa-caret-down"></i>
            </a>
            <div style="display: none; position: absolute; background-color: white; min-width: 180px; border-radius: 5px; overflow: hidden; box-shadow: 0px 4px 10px rgba(0,0,0,0.1);">
                <a href="cardiologist.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Cardiologist</a>
                <a href="neuralogist.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Neurologist</a>
                <a href="dermatologist.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Dermatologist</a>
            </div>
        </div>

        <div style="position: relative;">
            <a href="fertility.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">
                Fertility <i class="fas fa-caret-down"></i>
            </a>
            <div style="display: none; position: absolute; background-color: white; min-width: 180px; border-radius: 5px; overflow: hidden; box-shadow: 0px 4px 10px rgba(0,0,0,0.1);">
                <a href="IVF.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">IVF</a>
                <a href="iui.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">IUI</a>
                <a href="sarogasi.html" style="display: block; padding: 12px 16px; text-decoration: none; color: #333;">Surrogacy</a>
            </div>
        </div>

        <a href="ai.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">AI & Blockchain</a>
        <a href="doctor.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">Doctors</a>
        <a href="patientLogin.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">Patients</a>
        <a href="Cancer.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">Cancer</a>
        <a href="Dental.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">Dental</a>
        <a href="ENT.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">ENT</a>
        <a href="contact.html" style="color: white; text-decoration: none; padding: 0.5rem 1rem; font-weight: bold;">Contact</a>
    </div>
</nav>

<script>
  // Navbar 1
  function toggleMenu1() {
    const navItems = document.getElementById('navItems1');
    const hamburger = document.getElementById('hamburger1');
    const closeIcon = document.getElementById('closeIcon1');
    const isHidden = navItems.style.display === 'none' || navItems.style.display === '';
    if (isHidden) {
      navItems.style.display = 'flex';
      navItems.style.flexDirection = 'column';
      hamburger.style.display = 'none';
      closeIcon.style.display = 'block';
    } else {
      navItems.style.display = 'none';
      hamburger.style.display = 'block';
      closeIcon.style.display = 'none';
    }
  }
  function checkScreenWidth1() {
    const navItems = document.getElementById('navItems1');
    const hamburger = document.getElementById('hamburger1');
    const closeIcon = document.getElementById('closeIcon1');
    if (window.innerWidth <= 768) {
      navItems.style.display = 'none';
      hamburger.style.display = 'block';
      closeIcon.style.display = 'none';
    } else {
      navItems.style.display = 'flex';
      navItems.style.flexDirection = 'row';
      hamburger.style.display = 'none';
      closeIcon.style.display = 'none';
    }
  }
  window.addEventListener('resize', checkScreenWidth1);
  window.addEventListener('DOMContentLoaded', checkScreenWidth1);

  // Navbar 2
  function toggleMenu2() {
    const nav = document.getElementById("navLinks2");
    const ham = document.getElementById("hamburger2");
    const close = document.getElementById("closeIcon2");
    if (nav.style.display === "none" || nav.style.display === "") {
        nav.style.display = "flex";
        nav.style.flexDirection = "column";
        nav.style.alignItems = "center";
        ham.style.display = "none";
        close.style.display = "block";
    } else {
        nav.style.display = "none";
        ham.style.display = "block";
        close.style.display = "none";
    }
  }
  function setResponsiveMenu2() {
    const nav = document.getElementById("navLinks2");
    const ham = document.getElementById("hamburger2");
    const close = document.getElementById("closeIcon2");
    if (window.innerWidth <= 768) {
        nav.style.display = "none";
        ham.style.display = "block";
        close.style.display = "none";
    } else {
        nav.style.display = "flex";
        nav.style.flexDirection = "row";
        nav.style.justifyContent = "center";
        ham.style.display = "none";
        close.style.display = "none";
    }
  }
  window.addEventListener('resize', setResponsiveMenu2);
  window.addEventListener('DOMContentLoaded', setResponsiveMenu2);

  // Dropdowns on hover (desktop) and tap (mobile) for Navbar 2
  function setupDropdowns2() {
    document.querySelectorAll('#navLinks2 > div').forEach(item => {
        const dropdown = item.querySelector('div');
        item.onmouseenter = null;
        item.onmouseleave = null;
        item.onclick = null;
        if (dropdown) {
            if (window.innerWidth > 768) {
                item.addEventListener('mouseenter', () => dropdown.style.display = 'block');
                item.addEventListener('mouseleave', () => dropdown.style.display = 'none');
            } else {
                item.addEventListener('click', function(e) {
                    if (e.target === item.querySelector('a')) {
                        e.preventDefault();
                        dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
                    }
                });
            }
        }
    });
  }
  window.addEventListener('resize', setupDropdowns2);
  window.addEventListener('DOMContentLoaded', setupDropdowns2);
</script>









<div id="patients" class="section" style="display: block; background: #fff; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); padding: 0; margin: 20px; height: 600px; overflow: hidden; font-family: 'Segoe UI', sans-serif;">
  <div style="display: flex; height: 100%;">
    
    <!-- Sidebar -->
    <div style="width: 30%; border-right: 1px solid #ddd; background: #ffffff; display: flex; flex-direction: column; color: black;">
      <div style="padding: 15px; font-size: 18px; font-weight: bold; border-bottom: 1px solid #ccc; background-image: url('https://via.placeholder.com/300x100/007bff/ffffff'); background-size: cover; background-repeat: no-repeat; color:black;">Chats</div>
      <input type="text" placeholder="Search or start a new chat" style="margin: 10px; padding: 8px 12px; border-radius: 20px; border: none; background: #f0f2f5; font-size: 14px;">
      <div id="patientList" style="flex-grow: 1; overflow-y: auto; padding: 10px;"></div>
    </div>

    <!-- Chat Box -->
    <div style="width: 70%; display: flex; flex-direction: column; background: #efeae2;">
      
      <!-- Header -->
      <div style="display: flex; align-items: center; justify-content: space-between; background: #f0f2f5; padding: 10px 15px; border-bottom: 1px solid #ccc;">
        <div style="display: flex; align-items: center; gap: 10px;">
          <img src="" id="chatUserImage" alt="User" style="width: 40px; height: 40px; border-radius: 50%; background: #ccc;">
          <span id="chatUserName" style="font-weight: bold; font-size: 16px;">Select a patient</span>
        </div>
        <div style="display: flex; gap: 15px; align-items: center;">
          <button style="background: none; border: none; cursor: pointer; font-size: 18px;">
            <i class="fa fa-video-camera"></i>
          </button>
        </div>
      </div>

      <!-- Messages -->
      <div id="chatBox" style="flex-grow: 1; padding: 20px; overflow-y: auto; background-image: url('https://www.transparenttextures.com/patterns/white-wall-3.png'); background-size: contain;">
        <div id="messagesContainer">
          <p style="color: gray; text-align: center;">Select a patient to start chatting...</p>
        </div>
      </div>

      <!-- Input -->
      <div style="display: flex; align-items: center; padding: 10px; background: #f0f2f5; border-top: 1px solid #ccc; gap: 10px;">
        <!-- File Upload Button -->
<!-- Plus Button with Popup -->
<div style="position: relative;">
    <button onclick="toggleFileOptions()" style="background: none; border: none; font-size: 20px; cursor: pointer;">
      <i class="fa fa-plus"></i>
    </button>
  
    <!-- File Options Menu -->
    <div id="fileOptions" style="display: none; position: absolute; bottom: 40px; left: 0; background: white; border: 1px solid #ccc; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.2); z-index: 100;">
      <div onclick="uploadFile('image')" style="padding: 10px 15px; cursor: pointer;">📷 Image</div>
      <div onclick="uploadFile('document')" style="padding: 10px 15px; cursor: pointer;">📄 Document</div>
      <div onclick="uploadFile('audio')" style="padding: 10px 15px; cursor: pointer;">🎵 Audio</div>
      <div onclick="uploadFile('video')" style="padding: 10px 15px; cursor: pointer;">🎥 Video</div>
    </div>
  
    <!-- Hidden File Inputs -->
    <input type="file" id="imageUpload" accept="image/*" style="display: none;">
    <input type="file" id="documentUpload" accept=".pdf,.doc,.docx,.txt" style="display: none;">
    <input type="file" id="audioUpload" accept="audio/*" style="display: none;">
    <input type="file" id="videoUpload" accept="video/*" style="display: none;">
  </div>
  
        
        <input type="text" placeholder="Type a message" style="flex-grow: 1; padding: 10px 15px; border-radius: 20px; border: none; font-size: 14px;">
        <button style="background: none; border: none; font-size: 20px; cursor: pointer;">
          <i class="fa fa-paper-plane"></i>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Style -->
<style>
  .chat-user.active {
    background: #dfe6e9;
    border-radius: 8px;
  }

  .message-card {
    max-width: 70%;
    background: white;
    color: black;
    padding: 10px 15px;
    margin-bottom: 10px;
    border-radius: 10px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    display: inline-block;
    clear: both;
  }

  .sent-message {
    align-self: flex-end;
    background: #dcf8c6;
    float: right;
  }

  .received-message {
    align-self: flex-start;
    background: #ffffff;
    float: left;
  }
</style>

<!-- Script -->
<script>
    const patients = [
      { id: 1, name: "John Doe", image: "https://via.placeholder.com/40" },
      { id: 2, name: "Jane Smith", image: "https://via.placeholder.com/40" },
      { id: 3, name: "Ravi Kumar", image: "https://via.placeholder.com/40" }
    ];
  
    let chats = {};
    let selectedPatient = null;
  
    const patientList = document.getElementById("patientList");
    const chatUserImage = document.getElementById("chatUserImage");
    const chatUserName = document.getElementById("chatUserName");
    const messagesContainer = document.getElementById("messagesContainer");
    const messageInput = document.querySelector('#patients input[placeholder="Type a message"]');
    const sendBtn = document.querySelector('.fa-paper-plane').parentElement;
    const searchInput = document.querySelector('#patients input[placeholder="Search or start a new chat"]');
  
    function loadPatientList(filter = "") {
      patientList.innerHTML = "";
  
      let filteredPatients = patients.filter(p => p.name.toLowerCase().includes(filter.toLowerCase()));
      
      if (filteredPatients.length === 0 && filter.trim() !== "") {
        const newId = Date.now();
        const newPatient = { id: newId, name: filter.trim(), image: "https://via.placeholder.com/40" };
        patients.push(newPatient);
        filteredPatients = [newPatient];
      }
  
      filteredPatients.forEach((patient) => {
        const patientDiv = document.createElement("div");
        patientDiv.className = "chat-user";
        patientDiv.style.padding = "10px";
        patientDiv.style.cursor = "pointer";
        patientDiv.style.display = "flex";
        patientDiv.style.alignItems = "center";
        patientDiv.style.gap = "10px";
  
        patientDiv.innerHTML = `
          <img src="${patient.image}" alt="Avatar" style="width: 30px; height: 30px; border-radius: 50%;">
          <span>${patient.name}</span>
        `;
  
        patientDiv.addEventListener("click", () => selectPatient(patient, patientDiv));
        patientList.appendChild(patientDiv);
      });
    }
  
    function selectPatient(patient, element) {
      selectedPatient = patient;
      chatUserImage.src = patient.image;
      chatUserName.textContent = patient.name;
  
      document.querySelectorAll(".chat-user").forEach(el => el.classList.remove("active"));
      if (element) element.classList.add("active");
  
      renderMessages(patient.id);
    }
  
    function renderMessages(patientId) {
      messagesContainer.innerHTML = "";
  
      const messages = chats[patientId] || [];
  
      if (messages.length === 0) {
        messagesContainer.innerHTML = <p style="color: gray; text-align: center;">Start a conversation...</p>;
        return;
      }
  
      messages.forEach(msg => {
        const messageDiv = document.createElement("div");
        messageDiv.className = `message-card ${msg.sender === 'me' ? 'sent-message' : 'received-message'}`;
        messageDiv.textContent = msg.text;
        messagesContainer.appendChild(messageDiv);
      });
  
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }
  
    function sendMessage() {
      if (!selectedPatient) {
        alert("Please select or start a new chat.");
        return;
      }
  
      const text = messageInput.value.trim();
      if (text === "") return;
  
      const patientId = selectedPatient.id;
      if (!chats[patientId]) chats[patientId] = [];
  
      chats[patientId].push({ sender: 'me', text });
      messageInput.value = "";
      renderMessages(patientId);
  
      setTimeout(() => {
        chats[patientId].push({ sender: 'them', text: "Thank you for your message." });
        renderMessages(patientId);
      }, 1000);
    }
  
    // Handle Enter in message input
    messageInput.addEventListener("keydown", function (e) {
      if (e.key === 'Enter') sendMessage();
    });
  
    sendBtn.addEventListener("click", sendMessage);
  
    // Live search or create
    searchInput.addEventListener("input", function () {
      loadPatientList(searchInput.value);
    });
  
    searchInput.addEventListener("keydown", function (e) {
      if (e.key === "Enter") {
        const name = searchInput.value.trim();
        if (!name) return;
  
        const existing = patients.find(p => p.name.toLowerCase() === name.toLowerCase());
  
        if (existing) {
          const allUsers = document.querySelectorAll(".chat-user");
          const userDiv = [...allUsers].find(div => div.textContent.trim() === existing.name);
          selectPatient(existing, userDiv);
        } else {
          const newId = Date.now();
          const newPatient = { id: newId, name: name, image: "https://via.placeholder.com/40" };
          patients.push(newPatient);
          loadPatientList();
          setTimeout(() => {
            const allUsers = document.querySelectorAll(".chat-user");
            const userDiv = [...allUsers].find(div => div.textContent.trim() === newPatient.name);
            selectPatient(newPatient, userDiv);
          }, 100);
        }
  
        searchInput.value = "";
      }
    });
  
    // Initial list
    loadPatientList();
    const fileInput = document.getElementById("fileUpload");

  fileInput.addEventListener("change", function () {
    const file = fileInput.files[0];
    if (!file || !selectedPatient) return;

    const reader = new FileReader();
    reader.onload = function (e) {
      const fileURL = e.target.result;

      const patientId = selectedPatient.id;
      if (!chats[patientId]) chats[patientId] = [];

      // Add file message
      chats[patientId].push({
        sender: 'me',
        text: [File],
        file: {
          name: file.name,
          url: fileURL,
        }
      });

      renderMessages(patientId);
    };
    reader.readAsDataURL(file);
  });

  // Extend renderMessages to handle file display
  function renderMessages(patientId) {
    messagesContainer.innerHTML = "";

    const messages = chats[patientId] || [];

    if (messages.length === 0) {
      messagesContainer.innerHTML = <p style="color: gray; text-align: center;">Start a conversation...</p>;
      return;
    }

    messages.forEach(msg => {
      const messageDiv = document.createElement("div");
      messageDiv.className = `message-card ${msg.sender === 'me' ? 'sent-message' : 'received-message'}`;

      if (msg.file) {
        const link = document.createElement("a");
        link.href = msg.file.url;
        link.target = "_blank";
        link.textContent = `📎 ${msg.file.name}`;
        link.style.textDecoration = "none";
        link.style.color = "#007bff";
        messageDiv.appendChild(link);
      } else {
        messageDiv.textContent = msg.text;
      }

      messagesContainer.appendChild(messageDiv);
    });

    messagesContainer.scrollTop = messagesContainer.scrollHeight;
  }


  function toggleFileOptions() {
    const menu = document.getElementById('fileOptions');
    menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
  }

  function uploadFile(type) {
    document.getElementById('fileOptions').style.display = 'none'; // hide menu

    switch(type) {
      case 'image':
        document.getElementById('imageUpload').click();
        break;
      case 'document':
        document.getElementById('documentUpload').click();
        break;
      case 'audio':
        document.getElementById('audioUpload').click();
        break;
      case 'video':
        document.getElementById('videoUpload').click();
        break;
    }
  }

  // Event listeners for file inputs
  document.getElementById('imageUpload').addEventListener('change', handleFileSelect);
  document.getElementById('documentUpload').addEventListener('change', handleFileSelect);
  document.getElementById('audioUpload').addEventListener('change', handleFileSelect);
  document.getElementById('videoUpload').addEventListener('change', handleFileSelect);

  function handleFileSelect(event) {
    const file = event.target.files[0];
    if (file) {
      alert(`Selected: ${file.name}`);
      // Add logic here to preview/send file in chat
    }
  }


</script>
  

</body>
</html>